Лабораторная работа 6: Рефакторинг
Проблемы качества кода (Code Smells)
Long Method — функция process_checkout содержала более 50 строк и совмещала валидацию, расчёты и формирование ответа.

Magic Numbers — в коде использовались числовые значения (0.10, 0.20, 0.05, 0.21, 50, 10, 100, 200) без пояснений.

Нарушение SRP — одна функция отвечала за валидацию входных данных, расчёт скидок, вычисление налогов и генерацию ID заказа.

Дублирование логики — цикл по элементам items повторялся для валидации и подсчёта суммы.

Неявные значения по умолчанию — значение валюты "USD" было захардкожено внутри функции.

Применённые рефакторинги
Extract Constant — вынесены константы: TAX_RATE, DEFAULT_CURRENCY, а также параметры купонов.

Extract Method — созданы специализированные функции: validate_request, _validate_item, calculate_subtotal, calculate_discount, calculate_tax, generate_order_id.

Replace Loop with Pipeline — для подсчёта суммы использована функция sum() вместо ручного цикла в calculate_subtotal.

Simplify Conditional — упрощена логика расчёта скидок с использованием early return.

Replace Temp with Query — применена функция max(subtotal - discount, 0) вместо условного блока.

Что улучшилось
Читаемость — функция process_checkout теперь занимает менее 10 строк и читается как последовательный сценарий сверху вниз.

Тестируемость — каждую выделенную функцию можно тестировать отдельно.

Изменяемость — для изменения ставки налога или параметров скидок достаточно отредактировать одну константу.

Соблюдение DRY — валидация отдельного товара вынесена в функцию _validate_item, устраняя дублирование.

Соблюдение KISS — каждая функция выполняет одно простое действие.

Проверка рефакторинга
Все существующие тесты продолжают проходить успешно:
